C51 COMPILER V9.02   TEXT1                                                                 01/30/2020 18:29:35 PAGE 1   


C51 COMPILER V9.02, COMPILATION OF MODULE TEXT1
OBJECT MODULE PLACED IN Text1.OBJ
COMPILER INVOKED BY: C:\Users\99702\Documents\keil\C51\BIN\C51.EXE Text1.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          //-----------------------------------------------------------------
   2          //  名称: TIMER0、TIMER1及INT0控制报警器与旋转灯
   3          //-----------------------------------------------------------------
   4          //  说明: 定时器控制报警灯旋转显示,并发出仿真警报声
   5          //
   6          //-----------------------------------------------------------------
   7          #include <reg51.h>
   8          #include <intrins.h>
   9          #define INT8U   unsigned char
  10          #define INT16U  unsigned int
  11          sbit SPK = P3^7;
  12          INT8U FRQ = 0x00; 
  13          //-----------------------------------------------------------------
  14          // 延时子程序
  15          //-----------------------------------------------------------------
  16          void delayms(INT16U ms) 
  17          {                                               
  18   1              INT8U i; while(ms--) for(i = 0; i < 120; i++);
  19   1      }
  20          
  21          //-----------------------------------------------------------------
  22          // 主程序
  23          //-----------------------------------------------------------------
  24          void main()
  25          {
  26   1              P2 = 0x00;                      //关闭所有LED
  27   1              TMOD = 0x11;            //两个定时器均工作在模式1
  28   1              TH0     = 0xFE;                 //定时初值为0xFE00
  29   1              TL0 = 0x00;
  30   1              IT0 = 1;                        //下降沿触发INT0中断
  31   1              IE = 0x8B;                      //开启0、1、3号中断（INT0、T0、T1）
  32   1              IP = 0x01;                      //INT0设为高优先级
  33   1              TR0 = 0;                        //定时器启停由INT0中断控制，初始时关闭
  34   1              TR1 = 0;
  35   1              while(1)                        //循环过程中递增频率，溢出后再次递增
  36   1              {
  37   2                      FRQ++;
  38   2                      delayms(1);
  39   2              }
  40   1      }
  41          
  42          //-----------------------------------------------------------------
  43          // INT0中断程序
  44          //-----------------------------------------------------------------
  45          void EX0_INT() interrupt 0 
  46          {
  47   1              TR0 = !TR0;                     //开启或停止两个定时器，分别控制报警器声音和LED旋转
  48   1              TR1 = !TR1;
  49   1              if (P2 == 0x00)
  50   1                      P2 = 0xE0;              //开三个灯旋转（0xE0即 11100000）
  51   1              else
  52   1                      P2 = 0x00;              //关闭所有LED
  53   1      }
  54          
  55          //-----------------------------------------------------------------
C51 COMPILER V9.02   TEXT1                                                                 01/30/2020 18:29:35 PAGE 2   

  56          // 定时器0中断程序
  57          //-----------------------------------------------------------------
  58          void T0_INT() interrupt 1 
  59          {
  60   1               TH0 = 0xFE;
  61   1               TL0 = FRQ;
  62   1               SPK = ~SPK;
  63   1      }
  64          
  65          //-----------------------------------------------------------------
  66          // 定时器1中断程序
  67          //-----------------------------------------------------------------
  68          void T1_INT() interrupt 3
  69          {
  70   1              TH1 = -45000 >> 8;
  71   1              TL1 = -45000 & 0x1F;
  72   1              P2 = _crol_(P2,1);
  73   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    125    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      1    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
