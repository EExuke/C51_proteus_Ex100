//-----------------------------------------------------------------
//  名称: 数码管显示的GP2D12仿真测距警报器
//-----------------------------------------------------------------
//  说明: 程序运行时,数码管显示当前距离,当距离小于30CM时输出报警声音.
//
//-----------------------------------------------------------------
#define INT8U  unsigned char
#define INT16U unsigned int
#define INT32U unsigned long
#include <reg51.h>
#include <intrins.h>
#include <stdio.h>
#include <math.h>
//595引脚定义
sbit DS		= P3^5;				//输出锁存器控制脉冲
sbit SH_CP	= P3^6;				//串行数据输入 
sbit ST_CP	= P3^7;				//移位时钟脉冲
#define BEEP() P1 ^= (1<<0)		//蜂鸣器定义

//线性化系数(先实测8个距离的输出电压数据,再通过EXCEL表格公式计算得到)



//乘幂拟合曲线系数(通过EXCEL添加乘幂趋势线得到公式系数)



code INT8U SEG_CODE[] =			//共阴数码管段码表
{ 0xC0,0xF9,0xA4,0xB0,0x99,0x92,0x82,0xF8,0x80,0x90 };
INT8U Disp_Buff[] = {0,0,0};	//距离显示缓冲(小数位,个位,十位)
extern INT8U Get_CHx_AD_Value(INT8U ch);
//-----------------------------------------------------------------
// 延时函数
//-----------------------------------------------------------------
void delay_ms(INT16U x){INT8U t; while(x--) for(t = 0; t<120; t++);}
//------------------------------------------------------------------
// 报警程序
//------------------------------------------------------------------
void Alarm() 
{ 
	INT8U i,j;
	for(i = 0; i < 200; i++) { BEEP(); j = 150; while (--j); }
}
	
//-----------------------------------------------------------------
// 串行输入子程序
//-----------------------------------------------------------------
void Serial_Input_595(INT8U dat)
{



}

//-----------------------------------------------------------------
// 并行输出子程序
//-----------------------------------------------------------------
void Parallel_Output_595()
{


}

//-----------------------------------------------------------------
// 进行连续采样,然后根据采样平均值及计算公式得到距离
//-----------------------------------------------------------------
float Get_Distance()
{


}

//-----------------------------------------------------------------
// 将3位整数分解为3个数位
//-----------------------------------------------------------------
void DEC_TO_3DIGIT(INT16U d)
{



}

//------------------------------------------------------------------
// 主程序
//------------------------------------------------------------------
void main() 
{ 


}